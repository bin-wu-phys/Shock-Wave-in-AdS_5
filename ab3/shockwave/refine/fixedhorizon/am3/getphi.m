function phi = getphi(dr,dri, B, S, theta, tau, a1, a1t1, a1t2, a4, b4, b4t1, b4t2, L, N)

cb=L^(3/2)/(3*tau^(0.5))+((-2+3*tau*a1)*L^0.5)/(12*tau^(3/2))+((12+tau*a1*(-4+3*tau*a1))/L^0.5)/(96*tau^(5/2))+((-168-tau*a1*(268+5*tau*a1*(38+13*tau*a1))+768*tau^4*b4)*(1/L)^(3/2))/(384*tau^(7/2))+(1/(6144*tau^(9/2)))*(5680+tau*(2552*tau^2*a1^3+771*tau^3*a1^4+24*tau*a1^2*(259-96*tau^2*(a1t1))-32*a1*(-287+144*tau^2*(2*tau^2*b4+(a1t1)))+3072*(2*tau^3*b4-tau*(a1t1)+3*tau^4*(b4t1))))*(1/L)^(5/2)+1/(122880*tau^(11/2))*(-226144+tau*(-35150*tau^3*a1^4-9615*tau^4*a1^5+8*tau^2*a1^3*(-14539+7200*tau^2*(a1t1))+16*tau*a1^2*(-16711+480*tau^2*(15*tau^2*b4+17*(a1t1)-3*tau*(a1t2)))-16*a1*(23083+960*tau^2*(-13*(a1t1)+tau*(10*tau*b4+3*(tau*((a1t1)^2+5*tau*(b4t1))+(a1t2)))))+1024*tau*(140*(a1t1)+tau*(-30*(a1t2)+tau*(-8*a4-54*b4-45*(a1t1)^2+120*tau*(b4t1)+90*tau^2*(b4t2))))))*(1/L)^(7/2);
drphi = 3*(dr*B).*(S.^(-0.5)).*theta;
phi = [0; dri*drphi(2:N+1)] +cb;